{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '50399235-368a9bb0a02fac6949df8b962';\n\nexport async function getImagesByQuery(query, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: page,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    if (response.status !== 200) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return response.data;\n  } catch (error) {\n    console.error('Помилка запиту до Pixabay API:', error);\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-button');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction createImageCardMarkup(image) {\n  return `\n        <li class=\"gallery-item\">\n            <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n                <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" class=\"gallery-image\"/>\n            </a>\n            <div class=\"info\">\n                <div class=\"info-details\">\n                    <p class=\"info-item\">\n                        <b>Likes</b>\n                        <span>${image.likes}</span>\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Views</b>\n                        <span>${image.views}</span>\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Comments</b>\n                        <span>${image.comments}</span>\n                    </p>\n                    <p class=\"info-item\">\n                        <b>Downloads</b>\n                        <span>${image.downloads}</span>\n                    </p>\n                </div>\n            </div>\n        </li>\n    `;\n}\n\nexport function createGallery(images) {\n  if (!galleryElement) {\n    console.error('Елемент галереї не знайдено!');\n    return;\n  }\n  const markup = images.map(image => createImageCardMarkup(image)).join('');\n  galleryElement.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  if (galleryElement) {\n    galleryElement.innerHTML = '';\n  }\n}\n\nexport function showLoader() {\n  if (loaderElement) {\n    loaderElement.classList.remove('is-hidden');\n  }\n}\n\nexport function hideLoader() {\n  if (loaderElement) {\n    loaderElement.classList.add('is-hidden');\n  }\n}\n\nexport function showLoadMoreButton() {\n  if (loadMoreButtonElement) {\n    loadMoreButtonElement.classList.remove('is-hidden');\n  }\n}\n\nexport function hideLoadMoreButton() {\n  if (loadMoreButtonElement) {\n    loadMoreButtonElement.classList.add('is-hidden');\n  }\n}\n","import './css/styles.css';\n\nimport { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions.js';\nimport iziToast from 'izitoast';\niziToast.settings({\n  timeout: 3000,\n  resetOnHover: true,\n  icon: 'material-icons',\n  transitionIn: 'fadeInUp',\n  position: 'topRight',\n});\n\nconst form = document.querySelector('#search-form');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\nconst perPage = 15;\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  const formData = new FormData(searchForm);\n  const query = formData.get('searchQuery').trim();\n\n  if (!query) {\n    iziToast.warning({\n      title: 'Увага!',\n      message: 'Будь ласка, введіть пошуковий запит.',\n    });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  totalHits = 0;\n  clearGallery();\n  hideLoadMoreButton();\n  await fetchAndRenderImages();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage += 1;\n  await fetchAndRenderImages(true);\n});\n\nasync function fetchAndRenderImages(isLoadMore = false) {\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n    hideLoader();\n\n    if (!data.hits || data.hits.length === 0) {\n      if (!isLoadMore) {\n        iziToast.info({\n          title: 'На жаль,',\n          message:\n            'зображень за вашим запитом не знайдено. Спробуйте інший запит.',\n        });\n      }\n      hideLoadMoreButton();\n      return;\n    }\n\n    totalHits = data.totalHits;\n    createGallery(data.hits);\n\n    const loadedImagesCount = currentPage * perPage;\n\n    if (loadedImagesCount >= totalHits) {\n      hideLoadMoreButton();\n\n      if (totalHits > 0) {\n        iziToast.info({\n          title: 'Це все!',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    } else {\n      showLoadMoreButton();\n    }\n\n    if (isLoadMore && data.hits.length > 0) {\n      smoothScroll();\n    }\n  } catch (error) {\n    hideLoader();\n    iziToast.error({\n      title: 'Помилка!',\n      message: `Сталася помилка під час завантаження зображень: ${error.message}`,\n    });\n    console.error('Помилка в fetchAndRenderImages:', error);\n    hideLoadMoreButton();\n  }\n}\n\nfunction smoothScroll() {\n  const galleryItems = document.querySelectorAll('.gallery-item');\n  if (galleryItems.length > 0) {\n    const firstCard =\n      galleryItems[\n        galleryItems.length - Math.min(perPage, galleryItems.length)\n      ]; // одна з останніх доданих\n    if (firstCard) {\n      const cardHeight = firstCard.getBoundingClientRect().height;\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  }\n}\n"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","params","response","axios","error","lightbox","SimpleLightbox","createImageCardMarkup","image","createGallery","images","markup","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","iziToast","loadMoreBtn","currentQuery","currentPage","totalHits","perPage","event","fetchAndRenderImages","isLoadMore","data","smoothScroll","galleryItems","firstCard","cardHeight"],"mappings":"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"}